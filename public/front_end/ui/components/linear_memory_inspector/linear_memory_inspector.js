import*as e from"../../../core/common/common.js";import*as t from"../../lit-html/lit-html.js";import*as o from"../helpers/helpers.js";import*as r from"../../../core/i18n/i18n.js";import*as n from"../icon_button/icon_button.js";import*as s from"../../../core/platform/platform.js";import*as i from"../../../core/host/host.js";import*as a from"../../../core/sdk/sdk.js";import*as c from"../../legacy/legacy.js";const d=new CSSStyleSheet;d.replaceSync(":host{flex:auto;display:flex}.view{width:100%;display:flex;flex:1;flex-direction:column;font-family:var(--monospace-font-family);font-size:var(--monospace-font-size);padding:9px 12px 9px 7px}devtools-linear-memory-inspector-navigator+devtools-linear-memory-inspector-viewer{margin-top:12px}.value-interpreter{display:flex}\n/*# sourceURL=linearMemoryInspector.css */\n");const l=new CSSStyleSheet;l.replaceSync(".navigator{min-height:24px;display:flex;flex-wrap:nowrap;justify-content:space-between;overflow:hidden;align-items:center;background-color:var(--color-background);color:var(--color-text-primary)}.navigator-item{display:flex;white-space:nowrap;overflow:hidden}.address-input{text-align:center;outline:0;color:var(--color-text-primary);border:1px solid var(--color-background-elevation-2);background:0 0}.address-input.invalid{color:var(--color-accent-red)}.navigator-button{display:flex;width:20px;height:20px;background:0 0;overflow:hidden;border:none;padding:0;outline:0;justify-content:center;align-items:center;cursor:pointer}.navigator-button devtools-icon{height:14px;width:14px;min-height:14px;min-width:14px}.navigator-button:enabled:hover devtools-icon{--icon-color:var(--color-text-primary)}.navigator-button:enabled:focus devtools-icon{--icon-color:var(--color-text-secondary)}\n/*# sourceURL=linearMemoryNavigator.css */\n");const h={enterAddress:"Enter address",goBackInAddressHistory:"Go back in address history",goForwardInAddressHistory:"Go forward in address history",previousPage:"Previous page",nextPage:"Next page",refresh:"Refresh"},p=r.i18n.registerUIStrings("ui/components/linear_memory_inspector/LinearMemoryNavigator.ts",h),u=r.i18n.getLocalizedString.bind(void 0,p),{render:g,html:m}=t;class v extends Event{static eventName="addressinputchanged";data;constructor(e,t){super(v.eventName),this.data={address:e,mode:t}}}class y extends Event{static eventName="pagenavigation";data;constructor(e){super(y.eventName,{}),this.data=e}}class b extends Event{static eventName="historynavigation";data;constructor(e){super(b.eventName,{}),this.data=e}}class f extends Event{static eventName="refreshrequested";constructor(){super(f.eventName,{})}}class w extends HTMLElement{static litTagName=t.literal`devtools-linear-memory-inspector-navigator`;#e=this.attachShadow({mode:"open"});#t="0";#o=void 0;#r=!0;#n=!1;#s=!1;connectedCallback(){this.#e.adoptedStyleSheets=[l]}set data(e){this.#t=e.address,this.#o=e.error,this.#r=e.valid,this.#n=e.canGoBackInHistory,this.#s=e.canGoForwardInHistory,this.render();const t=this.#e.querySelector(".address-input");t&&("Submitted"===e.mode?t.blur():"InvalidSubmit"===e.mode&&t.select())}render(){const e=m` <div class="navigator"> <div class="navigator-item"> ${this.createButton({icon:"ic_undo_16x16_icon",title:u(h.goBackInAddressHistory),event:new b("Backward"),enabled:this.#n})} ${this.createButton({icon:"ic_redo_16x16_icon",title:u(h.goForwardInAddressHistory),event:new b("Forward"),enabled:this.#s})} </div> <div class="navigator-item"> ${this.createButton({icon:"ic_page_prev_16x16_icon",title:u(h.previousPage),event:new y("Backward"),enabled:!0})} ${this.createAddressInput()} ${this.createButton({icon:"ic_page_next_16x16_icon",title:u(h.nextPage),event:new y("Forward"),enabled:!0})} </div> ${this.createButton({icon:"refresh_12x12_icon",title:u(h.refresh),event:new f,enabled:!0})} </div> `;g(e,this.#e,{host:this})}createAddressInput(){const e={"address-input":!0,invalid:!this.#r};return m` <input class="${t.Directives.classMap(e)}" data-input="true" .value="${this.#t}" title="${this.#r?u(h.enterAddress):this.#o}" @change="${this.onAddressChange.bind(this,"Submitted")}" @input="${this.onAddressChange.bind(this,"Edit")}/">`}onAddressChange(e,t){const o=t.target;this.dispatchEvent(new v(o.value,e))}createButton(e){const t=e.enabled?"var(--color-text-secondary)":"var(--color-background-highlight)";return m` <button class="navigator-button" ?disabled="${!e.enabled}" data-button="${e.event.type}" title="${e.title}" @click="${this.dispatchEvent.bind(this,e.event)}"> <${n.Icon.Icon.litTagName} .data="${{iconName:e.icon,color:t,width:"14px"}}"> </${n.Icon.Icon.litTagName}> </button>`}}o.CustomElements.defineComponent("devtools-linear-memory-inspector-navigator",w);var x=Object.freeze({__proto__:null,AddressInputChangedEvent:v,PageNavigationEvent:y,HistoryNavigationEvent:b,RefreshRequestedEvent:f,LinearMemoryNavigator:w});const k=new CSSStyleSheet;k.replaceSync(":host{flex:auto;display:flex}.value-interpreter{--override-text-highlight-color:#80868b;border:var(--legacy-divider-border);background-color:var(--color-background-elevation-1);overflow:hidden;width:400px}.settings-toolbar{min-height:26px;display:flex;flex-wrap:nowrap;justify-content:space-between;padding-left:12px;padding-right:12px;align-items:center}.settings-toolbar-button{display:flex;justify-content:center;align-items:center;width:20px;height:20px;border:none;background-color:transparent;cursor:pointer}.settings-toolbar-button devtools-icon{height:14px;width:14px;min-height:14px;min-width:14px}.settings-toolbar-button.active devtools-icon{--icon-color:var(--color-primary)}.divider{display:block;height:1px;margin-bottom:12px;background-color:var(--color-details-hairline,#d0d0d0)}\n/*# sourceURL=linearMemoryValueInterpreter.css */\n");const T=new CSSStyleSheet;T.replaceSync('*{box-sizing:border-box;min-width:0;min-height:0}:root{height:100%;overflow:hidden;--legacy-accent-color:#1a73e8;--legacy-accent-fg-color:#1a73e8;--legacy-accent-color-hover:#3b86e8;--legacy-accent-fg-color-hover:#1567d3;--legacy-active-control-bg-color:#5a5a5a;--legacy-focus-bg-color:hsl(214deg 40% 92%);--legacy-focus-ring-inactive-shadow-color:#e0e0e0;--legacy-input-validation-error:#db1600;--legacy-toolbar-hover-bg-color:#eaeaea;--legacy-selection-fg-color:#fff;--legacy-selection-bg-color:var(--legacy-accent-color);--legacy-selection-inactive-fg-color:#5a5a5a;--legacy-selection-inactive-bg-color:#dadada;--legacy-tab-selected-fg-color:#333;--legacy-divider-border:1px solid var(--color-details-hairline);--legacy-focus-ring-inactive-shadow:0 0 0 1px var(--legacy-focus-ring-inactive-shadow-color);--legacy-focus-ring-active-shadow:0 0 0 1px var(--legacy-accent-color);--legacy-item-selection-bg-color:#cfe8fc;--legacy-item-selection-inactive-bg-color:#e0e0e0;--item-hover-color:rgb(56 121 217 / 10%);--monospace-font-size:10px;--monospace-font-family:monospace;--source-code-font-size:11px;--source-code-font-family:monospace;--override-force-white-icons-background:#fafafa}.-theme-with-dark-background{color-scheme:dark;--legacy-accent-color:#0e639c;--legacy-accent-fg-color:#ccc;--legacy-accent-fg-color-hover:#fff;--legacy-accent-color-hover:rgb(17 119 187);--legacy-active-control-bg-color:#cdcdcd;--legacy-focus-bg-color:hsl(214deg 19% 27%);--legacy-focus-ring-inactive-shadow-color:#5a5a5a;--legacy-toolbar-hover-bg-color:#202020;--legacy-selection-fg-color:#cdcdcd;--legacy-selection-inactive-fg-color:#cdcdcd;--legacy-selection-inactive-bg-color:hsl(0deg 0% 28%);--legacy-tab-selected-fg-color:#eaeaea;--legacy-focus-ring-inactive-shadow:0 0 0 1px var(--legacy-focus-ring-inactive-shadow-color);--legacy-item-selection-bg-color:hsl(207deg 88% 22%);--legacy-item-selection-inactive-bg-color:#454545}body{height:100%;width:100%;position:relative;overflow:hidden;margin:0;cursor:default;font-family:".SFNSDisplay-Regular","Helvetica Neue","Lucida Grande",sans-serif;font-size:12px;tab-size:4;user-select:none;color:var(--color-text-primary);background:var(--color-background)}.platform-linux{font-family:Roboto,Ubuntu,Arial,sans-serif}.platform-mac{font-family:".SFNSDisplay-Regular","Helvetica Neue","Lucida Grande",sans-serif}.platform-linux,.platform-mac{--override-text-color:rgb(48 57 66);color:var(--override-text-color)}.platform-windows{font-family:"Segoe UI",Tahoma,sans-serif}:focus{outline-width:0}.platform-mac,:host-context(.platform-mac){--monospace-font-size:11px;--monospace-font-family:menlo,monospace;--source-code-font-size:11px;--source-code-font-family:menlo,monospace}.platform-windows,:host-context(.platform-windows){--monospace-font-size:12px;--monospace-font-family:consolas,lucida console,courier new,monospace;--source-code-font-size:12px;--source-code-font-family:consolas,lucida console,courier new,monospace}.platform-linux,:host-context(.platform-linux){--monospace-font-size:11px;--monospace-font-family:dejavu sans mono,monospace;--source-code-font-size:11px;--source-code-font-family:dejavu sans mono,monospace}.-theme-with-dark-background .platform-linux,.-theme-with-dark-background .platform-mac,:host-context(.-theme-with-dark-background) .platform-linux,:host-context(.-theme-with-dark-background) .platform-mac{--override-text-color:rgb(189 198 207)}.monospace{font-family:var(--monospace-font-family);font-size:var(--monospace-font-size)!important}.source-code{font-family:var(--source-code-font-family);font-size:var(--source-code-font-size)!important;white-space:pre-wrap}img{-webkit-user-drag:none}a img,iframe{border:none}.fill{position:absolute;top:0;left:0;right:0;bottom:0}iframe.fill{width:100%;height:100%}.widget{position:relative;flex:auto;contain:style}.hbox{display:flex;flex-direction:row!important;position:relative}.vbox{display:flex;flex-direction:column!important;position:relative}.view-container>.toolbar{border-bottom:1px solid var(--color-details-hairline)}.flex-auto{flex:auto}.flex-none{flex:none}.flex-centered{display:flex;align-items:center;justify-content:center}.overflow-auto{overflow:auto;background-color:var(--color-background)}iframe.widget{position:absolute;width:100%;height:100%;left:0;right:0;top:0;bottom:0}.hidden{display:none!important}.highlighted-search-result{--override-highlighted-search-result-background-color:rgb(255 255 0 / 80%);border-radius:1px;background-color:var(--override-highlighted-search-result-background-color);outline:1px solid var(--override-highlighted-search-result-background-color)}.-theme-with-dark-background .highlighted-search-result,:host-context(.-theme-with-dark-background) .highlighted-search-result{--override-highlighted-search-result-background-color:hsl(133deg 100% 30%);color:#333}.link{cursor:pointer;text-decoration:underline;color:var(--color-link)}button,input,select{font-family:inherit;font-size:inherit}input,select optgroup,select option{background-color:var(--color-background)}input{color:inherit}input::placeholder{--override-input-placeholder-color:rgb(0 0 0 / 54%);color:var(--override-input-placeholder-color)}.-theme-with-dark-background input::placeholder,:host-context(.-theme-with-dark-background) input::placeholder{--override-input-placeholder-color:rgb(230 230 230 / 54%)}:host-context(.-theme-with-dark-background) input[type=checkbox]:not(.-theme-preserve){accent-color:var(--color-checkbox-accent-color)}.harmony-input:not([type]),.harmony-input[type=number],.harmony-input[type=text]{padding:3px 6px;height:24px;border:none;box-shadow:var(--legacy-focus-ring-inactive-shadow)}.harmony-input:not([type]).error-input,.harmony-input:not([type]):invalid,.harmony-input[type=number].error-input,.harmony-input[type=number]:invalid,.harmony-input[type=text].error-input,.harmony-input[type=text]:invalid{box-shadow:0 0 0 1px var(--color-red)}.harmony-input:not([type]):not(.error-input):not(:invalid):hover,.harmony-input[type=number]:not(.error-input):not(:invalid):hover,.harmony-input[type=text]:not(.error-input):not(:invalid):hover{box-shadow:var(--legacy-focus-ring-inactive-shadow)}.harmony-input:not([type]):not(.error-input):not(:invalid):focus,.harmony-input[type=number]:not(.error-input):not(:invalid):focus,.harmony-input[type=text]:not(.error-input):not(:invalid):focus{box-shadow:var(--legacy-focus-ring-active-shadow)}.highlighted-search-result.current-search-result{--override-current-search-result-background-color:rgb(255 127 0 / 80%);border-radius:1px;padding:1px;margin:-1px;background-color:var(--override-current-search-result-background-color)}.dimmed{opacity:60%}.editing{box-shadow:var(--drop-shadow);background-color:var(--color-background);text-overflow:clip!important;padding-left:2px;margin-left:-2px;padding-right:2px;margin-right:-2px;margin-bottom:-1px;padding-bottom:1px;opacity:100%!important}.editing,.editing *{color:var(--color-text-primary)!important;text-decoration:none!important}.chrome-select{--override-chrome-select-border-color:rgb(0 0 0 / 20%);appearance:none;user-select:none;border:1px solid var(--override-chrome-select-border-color);border-radius:2px;color:var(--color-text-primary);font:inherit;margin:0;outline:0;padding-right:20px;padding-left:6px;background-image:var(--image-file-chromeSelect);background-color:var(--color-background-elevation-0);background-position:right center;background-repeat:no-repeat;min-height:24px;min-width:80px;background-size:15px}.chrome-select:disabled{opacity:38%}.-theme-with-dark-background .chrome-select,:host-context(.-theme-with-dark-background) .chrome-select{--override-chrome-select-border-color:rgb(230 230 230 / 20%);background-image:var(--image-file-chromeSelectDark)}.chrome-select:enabled:active,.chrome-select:enabled:focus,.chrome-select:enabled:hover{--override-select-box-shadow:0 0 0 2px var(--color-button-outline-focus);background-color:var(--color-background-elevation-1);box-shadow:var(--override-select-box-shadow)}.chrome-select:enabled:active{background-color:var(--color-background-elevation-2)}.chrome-select:enabled:focus{border-color:transparent}.-theme-with-dark-background .chrome-select:enabled:active,.-theme-with-dark-background .chrome-select:enabled:focus,.-theme-with-dark-background .chrome-select:enabled:hover,:host-context(.-theme-with-dark-background) .chrome-select:enabled:active,:host-context(.-theme-with-dark-background) .chrome-select:enabled:focus,:host-context(.-theme-with-dark-background) .chrome-select:enabled:hover{--override-select-box-shadow:0 0 0 2px var(--color-button-outline-focus)}.chrome-select-label{margin:0 22px;flex:none}.chrome-select-label p p{margin-top:0;color:var(--color-text-secondary)}.settings-select{margin:0}.chrome-select optgroup,.chrome-select option{background-color:var(--color-background-elevation-1);color:var(--color-text-primary)}.gray-info-message{text-align:center;font-style:italic;padding:6px;color:var(--color-text-secondary);white-space:nowrap}span[is=dt-icon-label]{flex:none}.full-widget-dimmed-banner a{color:inherit}.full-widget-dimmed-banner{color:var(--color-text-secondary);background-color:var(--color-background);display:flex;justify-content:center;align-items:center;text-align:center;padding:20px;position:absolute;top:0;right:0;bottom:0;left:0;font-size:13px;overflow:auto;z-index:500}[is=ui-icon]{display:inline-block;flex-shrink:0}.-theme-with-dark-background [is=ui-icon].icon-invert,:host-context(.-theme-with-dark-background) [is=ui-icon].icon-invert{filter:invert(80%) hue-rotate(180deg)}[is=ui-icon].icon-mask{--override-icon-mask-background-color:rgb(110 110 110);background-color:var(--override-icon-mask-background-color);-webkit-mask-position:var(--spritesheet-position)}.-theme-with-dark-background [is=ui-icon].icon-mask,:host-context(.-theme-with-dark-background) [is=ui-icon].icon-mask{--override-icon-mask-background-color:rgb(145 145 145)}[is=ui-icon]:not(.icon-mask){background-position:var(--spritesheet-position)}.spritesheet-smallicons:not(.icon-mask){background-image:var(--image-file-smallIcons)}.spritesheet-smallicons.icon-mask{-webkit-mask-image:var(--image-file-smallIcons)}.spritesheet-largeicons:not(.icon-mask){background-image:var(--image-file-largeIcons)}.spritesheet-largeicons.icon-mask{-webkit-mask-image:var(--image-file-largeIcons)}.spritesheet-mediumicons:not(.icon-mask){background-image:var(--image-file-mediumIcons)}.spritesheet-mediumicons.icon-mask{-webkit-mask-image:var(--image-file-mediumIcons)}.spritesheet-arrowicons{background-image:var(--image-file-popoverArrows)}.-theme-preserve,.force-white-icons [is=ui-icon].spritesheet-smallicons,:host-context(.force-white-icons) [is=ui-icon].spritesheet-smallicons,[is=ui-icon].force-white-icons.spritesheet-smallicons{-webkit-mask-image:var(--image-file-smallIcons);-webkit-mask-position:var(--spritesheet-position);background:var(--override-force-white-icons-background)!important}.-theme-preserve,.force-white-icons [is=ui-icon].spritesheet-largeicons,:host-context(.force-white-icons) [is=ui-icon].spritesheet-largeicons,[is=ui-icon].force-white-icons.spritesheet-largeicons{-webkit-mask-image:var(--image-file-largeIcons);-webkit-mask-position:var(--spritesheet-position);background:var(--override-force-white-icons-background)!important}.-theme-preserve,.force-white-icons [is=ui-icon].spritesheet-mediumicons,:host-context(.force-white-icons) [is=ui-icon].spritesheet-mediumicons,[is=ui-icon].force-white-icons.spritesheet-mediumicons{-webkit-mask-image:var(--image-file-mediumIcons);-webkit-mask-position:var(--spritesheet-position);background:var(--override-force-white-icons-background)!important}.expandable-inline-button{background-color:var(--color-background-elevation-2);color:var(--color-text-primary);cursor:pointer;border-radius:3px}.expandable-inline-button,.undisplayable-text{padding:1px 3px;margin:0 2px;font-size:11px;font-family:sans-serif;white-space:nowrap;display:inline-block}.expandable-inline-button::after,.undisplayable-text::after{content:attr(data-text)}.undisplayable-text{color:var(--color-text-disabled);font-style:italic}.expandable-inline-button:focus-visible,.expandable-inline-button:hover{background-color:var(--color-background-elevation-1)}.expandable-inline-button:focus-visible{background-color:var(--color-background-elevation-1)}::selection{--override-selection-background-color:rgb(141 199 248 / 60%);background-color:var(--override-selection-background-color)}.-theme-with-dark-background ::selection,:host-context(.-theme-with-dark-background) ::selection{background-color:rgb(93 93 93 / 60%)}.reload-warning{align-self:center;margin-left:10px}button.link{border:none;background:0 0;padding:3px}button.link:focus-visible{--override-link-focus-background-color:rgb(0 0 0 / 8%);background-color:var(--override-link-focus-background-color);border-radius:2px}.-theme-with-dark-background button.link:focus-visible,:host-context(.-theme-with-dark-background) button.link:focus-visible{--override-link-focus-background-color:rgb(230 230 230 / 8%)}[data-aria-utils-animation-hack]{animation:ANIMATION-HACK 0s}@media (forced-colors:active){.chrome-select:disabled,.dimmed{opacity:100%}.-theme-preserve,.force-white-icons [is=ui-icon].spritesheet-largeicons,.force-white-icons [is=ui-icon].spritesheet-mediumicons,.force-white-icons [is=ui-icon].spritesheet-smallicons,:host-context(.force-white-icons) [is=ui-icon].spritesheet-largeicons,:host-context(.force-white-icons) [is=ui-icon].spritesheet-mediumicons,:host-context(.force-white-icons) [is=ui-icon].spritesheet-smallicons,[is=ui-icon].force-white-icons.spritesheet-largeicons,[is=ui-icon].force-white-icons.spritesheet-mediumicons,[is=ui-icon].force-white-icons.spritesheet-smallicons,[is=ui-icon].icon-mask{forced-color-adjust:none;background-color:ButtonText}.harmony-input:not([type]),.harmony-input[type=number],.harmony-input[type=text]{border:1px solid ButtonText}.harmony-input:not([type]):focus,.harmony-input[type=number]:focus,.harmony-input[type=text]:focus{border:1px solid Highlight}}input.custom-search-input::-webkit-search-cancel-button{appearance:none;cursor:pointer;width:16px;height:15px;margin-right:0;background-position:-32px 32px;background-image:var(--image-file-mediumIcons)}.spinner::before{display:block;width:var(--dimension,24px);height:var(--dimension,24px);border:var(--override-spinner-size,3px) solid var(--override-spinner-color,var(--color-text-secondary));border-radius:12px;clip:rect(0,var(--clip-size,15px),var(--clip-size,15px),0);content:"";position:absolute;animation:spinner-animation 1s linear infinite;box-sizing:border-box}@keyframes spinner-animation{from{transform:rotate(0)}to{transform:rotate(360deg)}}.adorner-container{display:inline-block}.adorner-container.hidden{display:none}.adorner-container devtools-adorner{margin-left:3px}:host-context(.-theme-with-dark-background) devtools-adorner{--override-adorner-background-color:rgb(var(--color-syntax-2-rgb) / 15%);--override-adorner-border-color:rgb(var(--color-syntax-2-rgb) / 50%);--override-adorner-focus-border-color:var(--color-syntax-2);--override-adorner-active-background-color:var(--color-syntax-8)}.panel{display:flex;overflow:hidden;position:absolute;top:0;left:0;right:0;bottom:0;z-index:0;background-color:var(--color-background)}.panel-sidebar{overflow-x:hidden;background-color:var(--color-background-elevation-1)}iframe.extension{flex:auto;width:100%;height:100%}iframe.panel.extension{display:block;height:100%}@media (forced-colors:active){:root{--legacy-accent-color:Highlight;--legacy-focus-ring-inactive-shadow-color:ButtonText}}\n/*# sourceURL=inspectorCommon.css */\n');const I=new CSSStyleSheet;I.replaceSync(":host{flex:auto;display:flex}.mode-type{color:var(--override-text-highlight-color)}.value-types{width:100%;display:grid;grid-template-columns:auto auto 1fr;gap:4px 24px;min-height:24px;overflow:hidden;padding:2px 12px;align-items:baseline;justify-content:start}.value-type-cell{text-overflow:ellipsis;white-space:nowrap;overflow:hidden;display:flex;flex-direction:column;min-height:24px}.value-type-value-with-link{display:flex;align-items:center}.value-type-cell-no-mode{grid-column:1/3}.jump-to-button{display:flex;width:20px;height:20px;border:none;padding:0;outline:0;justify-content:center;align-items:center;cursor:pointer}.signed-divider{width:1px;height:15px;background-color:var(--color-details-hairline);margin:0 4px}\n/*# sourceURL=valueInterpreterDisplay.css */\n");const S={notApplicable:"N/A"},M=r.i18n.registerUIStrings("ui/components/linear_memory_inspector/ValueInterpreterDisplayUtils.ts",S),E=r.i18n.getLocalizedString.bind(void 0,M);function $(){return new Map(R)}const R=new Map([["Integer 8-bit","dec"],["Integer 16-bit","dec"],["Integer 32-bit","dec"],["Integer 64-bit","dec"],["Float 32-bit","dec"],["Float 64-bit","dec"],["Pointer 32-bit","hex"],["Pointer 64-bit","hex"]]),A=["dec","hex","oct","sci"];function _(e){return r.i18n.lockedString(e)}function N(e,t){switch(e){case"Integer 8-bit":case"Integer 16-bit":case"Integer 32-bit":case"Integer 64-bit":return"dec"===t||"hex"===t||"oct"===t;case"Float 32-bit":case"Float 64-bit":return"sci"===t||"dec"===t;case"Pointer 32-bit":case"Pointer 64-bit":return"hex"===t;default:return s.assertNever(e,`Unknown value type: ${e}`)}}function O(e){switch(e){case"Integer 8-bit":case"Integer 16-bit":case"Integer 32-bit":case"Integer 64-bit":case"Float 32-bit":case"Float 64-bit":return!0;default:return!1}}function P(e,t,o){if(!B(e))return console.error(`Requesting address of a non-pointer type: ${e}.\n`),NaN;try{const r=new DataView(t),n="Little Endian"===o;return"Pointer 32-bit"===e?r.getUint32(0,n):r.getBigUint64(0,n)}catch(e){return NaN}}function B(e){return"Pointer 32-bit"===e||"Pointer 64-bit"===e}function L(e){if(!e.mode)return console.error(`No known way of showing value for ${e.type}`),E(S.notApplicable);const t=new DataView(e.buffer),o="Little Endian"===e.endianness;let r;try{switch(e.type){case"Integer 8-bit":return r=e.signed?t.getInt8(0):t.getUint8(0),V(r,e.mode);case"Integer 16-bit":return r=e.signed?t.getInt16(0,o):t.getUint16(0,o),V(r,e.mode);case"Integer 32-bit":return r=e.signed?t.getInt32(0,o):t.getUint32(0,o),V(r,e.mode);case"Integer 64-bit":return r=e.signed?t.getBigInt64(0,o):t.getBigUint64(0,o),V(r,e.mode);case"Float 32-bit":return r=t.getFloat32(0,o),C(r,e.mode);case"Float 64-bit":return r=t.getFloat64(0,o),C(r,e.mode);case"Pointer 32-bit":return r=t.getUint32(0,o),V(r,"hex");case"Pointer 64-bit":return r=t.getBigUint64(0,o),V(r,"hex");default:return s.assertNever(e.type,`Unknown value type: ${e.type}`)}}catch(e){return E(S.notApplicable)}}function C(e,t){switch(t){case"dec":return e.toFixed(2).toString();case"sci":return e.toExponential(2).toString();default:throw new Error(`Unknown mode for floats: ${t}.`)}}function V(e,t){switch(t){case"dec":return e.toString();case"hex":return e<0?E(S.notApplicable):"0x"+e.toString(16).toUpperCase();case"oct":return e<0?E(S.notApplicable):e.toString(8);default:throw new Error(`Unknown mode for integers: ${t}.`)}}var z=Object.freeze({__proto__:null,VALUE_INTEPRETER_MAX_NUM_BYTES:8,getDefaultValueTypeMapping:$,VALUE_TYPE_MODE_LIST:A,valueTypeToLocalizedString:_,isValidMode:N,isNumber:O,getPointerAddress:P,isPointer:B,format:L,formatFloat:C,formatInteger:V});const j={unsignedValue:"`Unsigned` value",changeValueTypeMode:"Change mode",signedValue:"`Signed` value",jumpToPointer:"Jump to address",addressOutOfRange:"Address out of memory range"},U=r.i18n.registerUIStrings("ui/components/linear_memory_inspector/ValueInterpreterDisplay.ts",j),D=r.i18n.getLocalizedString.bind(void 0,U),{render:H,html:F}=t,G=Array.from($().keys());class q extends Event{static eventName="valuetypemodechanged";data;constructor(e,t){super(q.eventName,{composed:!0}),this.data={type:e,mode:t}}}class W extends Event{static eventName="jumptopointeraddress";data;constructor(e){super(W.eventName,{composed:!0}),this.data=e}}class Y extends HTMLElement{static litTagName=t.literal`devtools-linear-memory-inspector-interpreter-display`;#e=this.attachShadow({mode:"open"});#i="Little Endian";#a=new ArrayBuffer(0);#c=new Set;#d=$();#l=0;constructor(){super(),this.#e.adoptedStyleSheets=[T]}connectedCallback(){this.#e.adoptedStyleSheets=[I]}set data(e){this.#a=e.buffer,this.#i=e.endianness,this.#c=e.valueTypes,this.#l=e.memoryLength,e.valueTypeModes&&e.valueTypeModes.forEach(((e,t)=>{N(t,e)&&this.#d.set(t,e)})),this.render()}render(){H(F` <div class="value-types"> ${G.map((e=>this.#c.has(e)?this.showValue(e):""))} </div> `,this.#e,{host:this})}showValue(e){if(O(e))return this.renderNumberValues(e);if(B(e))return this.renderPointerValue(e);throw new Error(`No known way to format ${e}`)}renderPointerValue(e){const t=this.parse({type:e,signed:!1}),o=P(e,this.#a,this.#i),s=Number.isNaN(o)||BigInt(o)>=BigInt(this.#l),i=D(s?j.addressOutOfRange:j.jumpToPointer),a=s?"var(--color-text-secondary)":"var(--color-primary)";return F` <span class="value-type-cell-no-mode value-type-cell">${r.i18n.lockedString(e)}</span> <div class="value-type-cell"> <div class="value-type-value-with-link" data-value="true"> <span>${t}</span> ${F` <button class="jump-to-button" data-jump="true" title="${i}" ?disabled="${s}" @click="${this.onJumpToAddressClicked.bind(this,Number(o))}"> <${n.Icon.Icon.litTagName} .data="${{iconName:"link_icon",color:a,width:"14px"}}"> </${n.Icon.Icon.litTagName}> </button>`} </div> </div> `}onJumpToAddressClicked(e){this.dispatchEvent(new W(e))}renderNumberValues(e){return F` <span class="value-type-cell">${r.i18n.lockedString(e)}</span> <div> <select title="${D(j.changeValueTypeMode)}" data-mode-settings="true" class="chrome-select" style="border: none; background-color: transparent; cursor: pointer; color: var(--color-text-secondary);" @change="${this.onValueTypeModeChange.bind(this,e)}"> ${A.filter((t=>N(e,t))).map((t=>F` <option value="${t}" .selected="${this.#d.get(e)===t}">${r.i18n.lockedString(t)} `))} </select> </div> ${this.renderSignedAndUnsigned(e)} `}renderSignedAndUnsigned(e){const t=this.parse({type:e,signed:!1}),o=this.parse({type:e,signed:!0}),r=this.#d.get(e),n=o!==t&&"hex"!==r&&"oct"!==r,s=F`<span class="value-type-cell" title="${D(j.unsignedValue)}" data-value="true">${t}</span>`;if(!n)return s;const i="Integer 32-bit"===e||"Integer 64-bit"===e,a=F`<span data-value="true" title="${D(j.signedValue)}">${o}</span>`;return i?F` <div class="value-type-cell"> ${s} ${a} </div> `:F` <div class="value-type-cell" style="flex-direction: row;"> ${s} <span class="signed-divider"></span> ${a} </div> `}onValueTypeModeChange(e,t){t.preventDefault();const o=t.target.value;this.dispatchEvent(new q(e,o))}parse(e){const t=this.#d.get(e.type);return L({buffer:this.#a,type:e.type,endianness:this.#i,signed:e.signed||!1,mode:t})}}o.CustomElements.defineComponent("devtools-linear-memory-inspector-interpreter-display",Y);var Z=Object.freeze({__proto__:null,ValueTypeModeChangedEvent:q,JumpToPointerAddressEvent:W,ValueInterpreterDisplay:Y});const K=new CSSStyleSheet;K.replaceSync(":host{flex:auto;display:flex;min-height:20px}.settings{display:flex;flex-wrap:wrap;margin:0 12px 12px;column-gap:45px;row-gap:15px}.value-types-selection{display:flex;flex-direction:column}.group{font-weight:700;margin-bottom:11px}.type-label{white-space:nowrap}.group+.type-label{margin-top:5px}.type-label input{margin:0 6px 0 0;padding:0}.type-label+.type-label{margin-top:6px}\n/*# sourceURL=valueInterpreterSettings.css */\n");const{render:J,html:X}=t,Q={otherGroup:"Other"},ee=r.i18n.registerUIStrings("ui/components/linear_memory_inspector/ValueInterpreterSettings.ts",Q),te=r.i18n.getLocalizedString.bind(void 0,ee),oe=new Map([["Integer",["Integer 8-bit","Integer 16-bit","Integer 32-bit","Integer 64-bit"]],["Floating point",["Float 32-bit","Float 64-bit"]],["Other",["Pointer 32-bit","Pointer 64-bit"]]]);class re extends Event{static eventName="typetoggle";data;constructor(e,t){super(re.eventName),this.data={type:e,checked:t}}}class ne extends HTMLElement{static litTagName=t.literal`devtools-linear-memory-inspector-interpreter-settings`;#e=this.attachShadow({mode:"open"});#c=new Set;connectedCallback(){this.#e.adoptedStyleSheets=[K]}set data(e){this.#c=e.valueTypes,this.render()}render(){J(X` <div class="settings"> ${[...oe.keys()].map((e=>X` <div class="value-types-selection"> <span class="group">${function(e){return"Other"===e?te(Q.otherGroup):e}(e)}</span> ${this.plotTypeSelections(e)} </div> `))} </div> `,this.#e,{host:this})}plotTypeSelections(e){const t=oe.get(e);if(!t)throw new Error(`Unknown group ${e}`);return X` ${t.map((e=>X` <label class="type-label" title="${_(e)}"> <input data-input="true" type="checkbox" .checked="${this.#c.has(e)}" @change="${t=>this.onTypeToggle(e,t)}"> <span data-title="true">${_(e)}</span> </label> `))}`}onTypeToggle(e,t){const o=t.target;this.dispatchEvent(new re(e,o.checked))}}o.CustomElements.defineComponent("devtools-linear-memory-inspector-interpreter-settings",ne);var se=Object.freeze({__proto__:null,TypeToggleEvent:re,ValueInterpreterSettings:ne});const ie={toggleValueTypeSettings:"Toggle value type settings",changeEndianness:"Change `Endianness`"},ae=r.i18n.registerUIStrings("ui/components/linear_memory_inspector/LinearMemoryValueInterpreter.ts",ie),ce=r.i18n.getLocalizedString.bind(void 0,ae),{render:de,html:le}=t;class he extends Event{static eventName="endiannesschanged";data;constructor(e){super(he.eventName),this.data=e}}class pe extends Event{static eventName="valuetypetoggled";data;constructor(e,t){super(pe.eventName),this.data={type:e,checked:t}}}class ue extends HTMLElement{static litTagName=t.literal`devtools-linear-memory-inspector-interpreter`;#e=this.attachShadow({mode:"open"});#i="Little Endian";#a=new ArrayBuffer(0);#c=new Set;#d=new Map;#l=0;#h=!1;connectedCallback(){this.#e.adoptedStyleSheets=[k]}set data(e){this.#i=e.endianness,this.#a=e.value,this.#c=e.valueTypes,this.#d=e.valueTypeModes||new Map,this.#l=e.memoryLength,this.render()}render(){de(le` <div class="value-interpreter"> <div class="settings-toolbar"> ${this.renderEndiannessSetting()} <button data-settings="true" class="settings-toolbar-button ${this.#h?"active":""}" title="${ce(ie.toggleValueTypeSettings)}" @click="${this.onSettingsToggle}"> <${n.Icon.Icon.litTagName} .data="${{iconName:"settings_14x14_icon",color:"var(--color-text-secondary)",width:"14px"}}"> </${n.Icon.Icon.litTagName}> </button> </div> <span class="divider"></span> <div> ${this.#h?le` <${ne.litTagName} .data="${{valueTypes:this.#c}}" @typetoggle="${this.onTypeToggle}"> </${ne.litTagName}>`:le` <${Y.litTagName} .data="${{buffer:this.#a,valueTypes:this.#c,endianness:this.#i,valueTypeModes:this.#d,memoryLength:this.#l}}"> </${Y.litTagName}>`} </div> </div> `,this.#e,{host:this})}onEndiannessChange(e){e.preventDefault();const t=e.target.value;this.dispatchEvent(new he(t))}renderEndiannessSetting(){const e=this.onEndiannessChange.bind(this);return le` <label data-endianness-setting="true" title="${ce(ie.changeEndianness)}"> <select class="chrome-select" style="border: none; background-color: transparent; cursor: pointer;" data-endianness="true" @change="${e}"> ${["Little Endian","Big Endian"].map((e=>le`<option value="${e}" .selected="${this.#i===e}">${r.i18n.lockedString(e)}`))} </select> </label> `}onSettingsToggle(){this.#h=!this.#h,this.render()}onTypeToggle(e){this.dispatchEvent(new pe(e.data.type,e.data.checked))}}o.CustomElements.defineComponent("devtools-linear-memory-inspector-interpreter",ue);var ge=Object.freeze({__proto__:null,EndiannessChangedEvent:he,ValueTypeToggledEvent:pe,LinearMemoryValueInterpreter:ue});const me=/^0x[a-fA-F0-9]+$/,ve=/^0$|[1-9]\d*$/;function ye(e){const t=e.number.toString(16).padStart(e.pad,"0").toUpperCase();return e.prefix?"0x"+t:t}function be(e){return ye({number:e,pad:8,prefix:!0})}function fe(e){const t=e.match(me),o=e.match(ve);let r;return t&&t[0].length===e.length?r=parseInt(e,16):o&&o[0].length===e.length&&(r=parseInt(e,10)),r}var we=Object.freeze({__proto__:null,HEXADECIMAL_REGEXP:me,DECIMAL_REGEXP:ve,toHexString:ye,formatAddress:be,parseAddress:fe});const xe=new CSSStyleSheet;xe.replaceSync(":host{flex:auto;display:flex;min-height:20px}.view{overflow:hidden;text-overflow:ellipsis;box-sizing:border-box;background:var(--color-background);outline:0}.row{display:flex;height:20px;align-items:center}.cell{text-align:center;border:1px solid transparent;border-radius:2px}.cell.selected{border-color:var(--color-syntax-3);color:var(--color-syntax-3);background-color:var(--legacy-item-selection-bg-color)}.byte-cell{min-width:21px;color:var(--color-text-primary)}.byte-group-margin{margin-left:var(--byte-group-margin)}.text-cell{min-width:14px;color:var(--color-syntax-3)}.address{color:var(--color-text-disabled)}.address.selected{font-weight:700;color:var(--color-text-primary)}.divider{width:1px;height:inherit;background-color:var(--color-details-hairline);margin:0 4px}\n/*# sourceURL=linearMemoryViewer.css */\n");const{render:ke,html:Te}=t;class Ie extends Event{static eventName="byteselected";data;constructor(e){super(Ie.eventName),this.data=e}}class Se extends Event{static eventName="resize";data;constructor(e){super(Se.eventName),this.data=e}}class Me extends HTMLElement{static litTagName=t.literal`devtools-linear-memory-inspector-viewer`;static BYTE_GROUP_MARGIN=8;static BYTE_GROUP_SIZE=4;#e=this.attachShadow({mode:"open"});#p=new ResizeObserver((()=>this.resize()));#u=!1;#g=new Uint8Array;#t=0;#m=0;#v=1;#y=Me.BYTE_GROUP_SIZE;#b=!0;#f=void 0;set data(e){if(e.address<e.memoryOffset||e.address>e.memoryOffset+e.memory.length||e.address<0)throw new Error("Address is out of bounds.");if(e.memoryOffset<0)throw new Error("Memory offset has to be greater or equal to zero.");this.#g=e.memory,this.#t=e.address,this.#m=e.memoryOffset,this.#b=e.focus,this.update()}connectedCallback(){o.SetCSSProperty.set(this,"--byte-group-margin",`${Me.BYTE_GROUP_MARGIN}px`),this.#e.adoptedStyleSheets=[xe]}disconnectedCallback(){this.#u=!1,this.#p.disconnect()}update(){this.updateDimensions(),this.render(),this.focusOnView(),this.engageResizeObserver()}focusOnView(){if(this.#b){const e=this.#e.querySelector(".view");e&&e.focus()}}resize(){this.update(),this.dispatchEvent(new Se(this.#y*this.#v))}updateDimensions(){if(0===this.clientWidth||0===this.clientHeight||!this.shadowRoot)return this.#y=Me.BYTE_GROUP_SIZE,void(this.#v=1);const e=this.shadowRoot.querySelector(".byte-cell"),t=this.shadowRoot.querySelector(".text-cell"),o=this.shadowRoot.querySelector(".divider"),r=this.shadowRoot.querySelector(".row");if(!(e&&t&&o&&r))return this.#y=Me.BYTE_GROUP_SIZE,void(this.#v=1);const n=e.getBoundingClientRect().width,s=t.getBoundingClientRect().width,i=Me.BYTE_GROUP_SIZE*(n+s)+Me.BYTE_GROUP_MARGIN,a=o.getBoundingClientRect().width,c=this.clientWidth-1-(e.getBoundingClientRect().left-this.getBoundingClientRect().left)-a;if(c<i)return this.#y=Me.BYTE_GROUP_SIZE,void(this.#v=1);this.#y=Math.floor(c/i)*Me.BYTE_GROUP_SIZE,this.#v=Math.floor(this.clientHeight/r.clientHeight)}engageResizeObserver(){this.#p&&!this.#u&&(this.#p.observe(this),this.#u=!0)}render(){ke(Te` <div class="view" tabindex="0" @keydown="${this.onKeyDown}"> ${this.renderView()} </div> `,this.#e,{host:this})}onKeyDown(e){const t=e;let o;"ArrowUp"===t.code?o=this.#t-this.#y:"ArrowDown"===t.code?o=this.#t+this.#y:"ArrowLeft"===t.code?o=this.#t-1:"ArrowRight"===t.code?o=this.#t+1:"PageUp"===t.code?o=this.#t-this.#y*this.#v:"PageDown"===t.code&&(o=this.#t+this.#y*this.#v),void 0!==o&&o!==this.#f&&(this.#f=o,this.dispatchEvent(new Ie(o)))}renderView(){const e=[];for(let t=0;t<this.#v;++t)e.push(this.renderRow(t));return Te`${e}`}renderRow(e){const{startIndex:o,endIndex:r}={startIndex:e*this.#y,endIndex:(e+1)*this.#y},n={address:!0,selected:Math.floor((this.#t-this.#m)/this.#y)===e};return Te` <div class="row"> <span class="${t.Directives.classMap(n)}">${ye({number:o+this.#m,pad:8,prefix:!1})}</span> <span class="divider"></span> ${this.renderByteValues(o,r)} <span class="divider"></span> ${this.renderCharacterValues(o,r)} </div> `}renderByteValues(e,o){const r=[];for(let n=e;n<o;++n){const o={cell:!0,"byte-cell":!0,"byte-group-margin":n!==e&&(n-e)%Me.BYTE_GROUP_SIZE==0,selected:n===this.#t-this.#m},s=n<this.#g.length,i=s?Te`${ye({number:this.#g[n],pad:2,prefix:!1})}`:"",a=n+this.#m,c=s?this.onSelectedByte.bind(this,a):"";r.push(Te`<span class="${t.Directives.classMap(o)}" @click="${c}">${i}</span>`)}return Te`${r}`}renderCharacterValues(e,o){const r=[];for(let n=e;n<o;++n){const e={cell:!0,"text-cell":!0,selected:this.#t-this.#m===n},o=n<this.#g.length,s=o?Te`${this.toAscii(this.#g[n])}`:"",i=o?this.onSelectedByte.bind(this,n+this.#m):"";r.push(Te`<span class="${t.Directives.classMap(e)}" @click="${i}">${s}</span>`)}return Te`${r}`}toAscii(e){return e>=20&&e<=127?String.fromCharCode(e):"."}onSelectedByte(e){this.dispatchEvent(new Ie(e))}}o.CustomElements.defineComponent("devtools-linear-memory-inspector-viewer",Me);var Ee=Object.freeze({__proto__:null,ByteSelectedEvent:Ie,ResizeEvent:Se,LinearMemoryViewer:Me});const{render:$e,html:Re}=t,Ae={addressHasToBeANumberBetweenSAnd:"Address has to be a number between {PH1} and {PH2}"},_e=r.i18n.registerUIStrings("ui/components/linear_memory_inspector/LinearMemoryInspector.ts",Ae),Ne=r.i18n.getLocalizedString.bind(void 0,_e);class Oe extends Event{static eventName="memoryrequest";data;constructor(e,t,o){super(Oe.eventName),this.data={start:e,end:t,address:o}}}class Pe extends Event{static eventName="addresschanged";data;constructor(e){super(Pe.eventName),this.data=e}}class Be extends Event{static eventName="settingschanged";data;constructor(e){super(Be.eventName),this.data=e}}class Le{#t=0;#w;constructor(e,t){if(e<0)throw new Error("Address should be a greater or equal to zero");this.#t=e,this.#w=t}valid(){return!0}reveal(){this.#w(this.#t)}}class Ce extends HTMLElement{static litTagName=t.literal`devtools-linear-memory-inspector-inspector`;#e=this.attachShadow({mode:"open"});#x=new e.SimpleHistoryManager.SimpleHistoryManager(10);#g=new Uint8Array;#m=0;#k=0;#t=-1;#T="Submitted";#I=`${this.#t}`;#S=4;#M=$();#c=new Set(this.#M.keys());#i="Little Endian";connectedCallback(){this.#e.adoptedStyleSheets=[d]}set data(e){if(e.address<e.memoryOffset||e.address>e.memoryOffset+e.memory.length||e.address<0)throw new Error("Address is out of bounds.");if(e.memoryOffset<0)throw new Error("Memory offset has to be greater or equal to zero.");this.#g=e.memory,this.#m=e.memoryOffset,this.#k=e.outerMemoryLength,this.#M=e.valueTypeModes||this.#M,this.#c=e.valueTypes||this.#c,this.#i=e.endianness||this.#i,this.setAddress(e.address),this.render()}render(){const{start:e,end:t}=this.getPageRangeForAddress(this.#t,this.#S),o="Submitted"===this.#T?be(this.#t):this.#I,r=this.isValidAddress(o),n=Ne(Ae.addressHasToBeANumberBetweenSAnd,{PH1:be(0),PH2:be(this.#k)}),s=r?void 0:n,i=this.#x.canRollback(),a=this.#x.canRollover();$e(Re` <div class="view"> <${w.litTagName} .data="${{address:o,valid:r,mode:this.#T,error:s,canGoBackInHistory:i,canGoForwardInHistory:a}}" @refreshrequested="${this.onRefreshRequest}" @addressinputchanged="${this.onAddressChange}" @pagenavigation="${this.navigatePage}" @historynavigation="${this.navigateHistory}"></${w.litTagName}> <${Me.litTagName} .data="${{memory:this.#g.slice(e-this.#m,t-this.#m),address:this.#t,memoryOffset:e,focus:"Submitted"===this.#T}}" @byteselected="${this.onByteSelected}" @resize="${this.resize}"> </${Me.litTagName}> </div> <div class="value-interpreter"> <${ue.litTagName} .data="${{value:this.#g.slice(this.#t-this.#m,this.#t+8).buffer,valueTypes:this.#c,valueTypeModes:this.#M,endianness:this.#i,memoryLength:this.#k}}" @valuetypetoggled="${this.onValueTypeToggled}" @valuetypemodechanged="${this.onValueTypeModeChanged}" @endiannesschanged="${this.onEndiannessChanged}" @jumptopointeraddress="${this.onJumpToPointerAddress}"> </${ue.litTagName}> </div> `,this.#e,{host:this})}onJumpToPointerAddress(e){e.stopPropagation(),this.#T="Submitted";const t=Math.max(0,Math.min(e.data,this.#k-1));this.jumpToAddress(t)}onRefreshRequest(){const{start:e,end:t}=this.getPageRangeForAddress(this.#t,this.#S);this.dispatchEvent(new Oe(e,t,this.#t))}onByteSelected(e){this.#T="Submitted";const t=Math.max(0,Math.min(e.data,this.#k-1));this.jumpToAddress(t)}createSettings(){return{valueTypes:this.#c,modes:this.#M,endianness:this.#i}}onEndiannessChanged(e){this.#i=e.data,this.dispatchEvent(new Be(this.createSettings())),this.render()}isValidAddress(e){const t=fe(e);return void 0!==t&&t>=0&&t<this.#k}onAddressChange(e){const{address:t,mode:o}=e.data,r=this.isValidAddress(t),n=fe(t);if(this.#I=t,void 0!==n&&r)return this.#T=o,void this.jumpToAddress(n);this.#T="Submitted"!==o||r?"Edit":"InvalidSubmit",this.render()}onValueTypeToggled(e){const{type:t,checked:o}=e.data;o?this.#c.add(t):this.#c.delete(t),this.dispatchEvent(new Be(this.createSettings())),this.render()}onValueTypeModeChanged(e){e.stopImmediatePropagation();const{type:t,mode:o}=e.data;this.#M.set(t,o),this.dispatchEvent(new Be(this.createSettings())),this.render()}navigateHistory(e){return"Forward"===e.data?this.#x.rollover():this.#x.rollback()}navigatePage(e){const t="Forward"===e.data?this.#t+this.#S:this.#t-this.#S,o=Math.max(0,Math.min(t,this.#k-1));this.jumpToAddress(o)}jumpToAddress(e){e<0||e>=this.#k?console.warn(`Specified address is out of bounds: ${e}`):(this.setAddress(e),this.update())}getPageRangeForAddress(e,t){const o=Math.floor(e/t)*t;return{start:o,end:Math.min(o+t,this.#k)}}resize(e){this.#S=e.data,this.update()}update(){const{start:e,end:t}=this.getPageRangeForAddress(this.#t,this.#S);e<this.#m||t>this.#m+this.#g.length?this.dispatchEvent(new Oe(e,t,this.#t)):this.render()}setAddress(e){if(this.#t===e)return;const t=new Le(e,(()=>this.jumpToAddress(e)));this.#x.push(t),this.#t=e,this.dispatchEvent(new Pe(this.#t))}}o.CustomElements.defineComponent("devtools-linear-memory-inspector-inspector",Ce);var Ve=Object.freeze({__proto__:null,MemoryRequestEvent:Oe,AddressChangedEvent:Pe,SettingsChangedEvent:Be,LinearMemoryInspector:Ce});const ze={noOpenInspections:"No open inspections"},je=r.i18n.registerUIStrings("ui/components/linear_memory_inspector/LinearMemoryInspectorPane.ts",ze),Ue=r.i18n.getLocalizedString.bind(void 0,je);let De,He;class Fe extends c.Widget.VBox{view;constructor(){super(),this.view=Ge.instance()}static instance(e={forceNew:null}){const{forceNew:t}=e;return He&&!t||(He=new Fe),He}wasShown(){this.view.show(this.contentElement)}}class Ge extends(e.ObjectWrapper.eventMixin(c.Widget.VBox)){#E;#$;constructor(){super(!1);const e=document.createElement("div");e.textContent=Ue(ze.noOpenInspections),e.style.display="flex",this.#E=new c.TabbedPane.TabbedPane,this.#E.setPlaceholderElement(e),this.#E.setCloseableTabs(!0),this.#E.setAllowTabReorder(!0,!0),this.#E.addEventListener(c.TabbedPane.Events.TabClosed,this.tabClosed,this),this.#E.show(this.contentElement),this.#$=new Map}static instance(){return De||(De=new Ge),De}create(e,t,o,r){const n=new qe(o,r);this.#$.set(e,n),this.#E.appendTab(e,t,n,void 0,!1,!0),this.#E.selectTab(e)}close(e){this.#E.closeTab(e,!1)}reveal(e,t){const o=this.#$.get(e);if(!o)throw new Error(`No linear memory inspector view for given tab id: ${e}`);void 0!==t&&o.updateAddress(t),this.refreshView(e),this.#E.selectTab(e)}refreshView(e){const t=this.#$.get(e);if(!t)throw new Error(`View for specified tab id does not exist: ${e}`);t.refreshData()}tabClosed(e){const{tabId:t}=e.data;this.#$.delete(t),this.dispatchEventToListeners("ViewClosed",t)}}class qe extends c.Widget.VBox{#R;#t;#A;firstTimeOpen;constructor(e,t=0){if(super(!1),t<0||t>=e.length())throw new Error("Requested address is out of bounds.");this.#R=e,this.#t=t,this.#A=new Ce,this.#A.addEventListener("memoryrequest",(e=>{this.memoryRequested(e)})),this.#A.addEventListener("addresschanged",(e=>{this.updateAddress(e.data)})),this.#A.addEventListener("settingschanged",(e=>{e.stopPropagation(),this.saveSettings(e.data)})),this.contentElement.appendChild(this.#A),this.firstTimeOpen=!0}wasShown(){this.refreshData()}saveSettings(e){Je.instance().saveSettings(e)}updateAddress(e){if(e<0||e>=this.#R.length())throw new Error("Requested address is out of bounds.");this.#t=e}refreshData(){Je.getMemoryForAddress(this.#R,this.#t).then((({memory:e,offset:t})=>{let o,r,n;if(this.firstTimeOpen){const e=Je.instance().loadSettings();o=e.valueTypes,r=e.modes,n=e.endianness,this.firstTimeOpen=!1}this.#A.data={memory:e,address:this.#t,memoryOffset:t,outerMemoryLength:this.#R.length(),valueTypes:o,valueTypeModes:r,endianness:n}}))}memoryRequested(e){const{start:t,end:o,address:r}=e.data;if(r<t||r>=o)throw new Error("Requested address is out of bounds.");Je.getMemoryRange(this.#R,t,o).then((e=>{this.#A.data={memory:e,address:r,memoryOffset:t,outerMemoryLength:this.#R.length()}}))}}var We=Object.freeze({__proto__:null,Wrapper:Fe,LinearMemoryInspectorPaneImpl:Ge});const Ye=["webassemblymemory","typedarray","dataview","arraybuffer"];let Ze;class Ke{#_;constructor(e){this.#_=e}length(){return this.#_.byteLength()}async getRange(e,t){const o=Math.min(t,this.length());if(e<0||e>o)return console.error(`Requesting invalid range of memory: (${e}, ${t})`),new Uint8Array(0);const r=await this.#_.bytes(e,o);return new Uint8Array(r)}}class Je extends a.TargetManager.SDKModelObserver{#N=Ge.instance();#O=new Map;#P;constructor(){super(),a.TargetManager.TargetManager.instance().observeModels(a.RuntimeModel.RuntimeModel,this),a.TargetManager.TargetManager.instance().addModelListener(a.DebuggerModel.DebuggerModel,a.DebuggerModel.Events.GlobalObjectCleared,this.onGlobalObjectClear,this),this.#N.addEventListener("ViewClosed",this.viewClosed.bind(this)),a.TargetManager.TargetManager.instance().addModelListener(a.DebuggerModel.DebuggerModel,a.DebuggerModel.Events.DebuggerPaused,this.onDebuggerPause,this);const t=$(),o={valueTypes:Array.from(t.keys()),valueTypeModes:Array.from(t),endianness:"Little Endian"};this.#P=e.Settings.Settings.instance().createSetting("lmiInterpreterSettings",o)}static instance(){return Ze||(Ze=new Je,Ze)}static async getMemoryForAddress(e,t){const o=Math.max(0,t-500),r=o+1e3;return{memory:await e.getRange(o,r),offset:o}}static async getMemoryRange(e,t,o){if(t<0||t>o||t>=e.length())throw new Error("Requested range is out of bounds.");const r=Math.max(o,t+1e3);return await e.getRange(t,r)}saveSettings(e){const t=Array.from(e.valueTypes),o=[...e.modes];this.#P.set({valueTypes:t,valueTypeModes:o,endianness:e.endianness})}loadSettings(){const e=this.#P.get();return{valueTypes:new Set(e.valueTypes),modes:new Map(e.valueTypeModes),endianness:e.endianness}}async openInspectorView(e,t){void 0!==t?i.userMetrics.linearMemoryInspectorTarget(i.UserMetrics.LinearMemoryInspectorTarget.DWARFInspectableAddress):"arraybuffer"===e.subtype?i.userMetrics.linearMemoryInspectorTarget(i.UserMetrics.LinearMemoryInspectorTarget.ArrayBuffer):"dataview"===e.subtype?i.userMetrics.linearMemoryInspectorTarget(i.UserMetrics.LinearMemoryInspectorTarget.DataView):"typedarray"===e.subtype?i.userMetrics.linearMemoryInspectorTarget(i.UserMetrics.LinearMemoryInspectorTarget.TypedArray):(console.assert("webassemblymemory"===e.subtype),i.userMetrics.linearMemoryInspectorTarget(i.UserMetrics.LinearMemoryInspectorTarget.WebAssemblyMemory));const o=await async function(e){console.assert("object"===e.type),console.assert(void 0!==e.subtype&&Ye.includes(e.subtype));const t=await e.runtimeModel().agent.invoke_callFunctionOn({objectId:e.objectId,functionDeclaration:"function() { return this instanceof ArrayBuffer || (typeof SharedArrayBuffer !== 'undefined' && this instanceof SharedArrayBuffer) ? this : this.buffer; }",silent:!0,objectGroup:"linear-memory-inspector"}),o=t.getError();if(o)throw new Error(`Remote object representing ArrayBuffer could not be retrieved: ${o}`);return e=e.runtimeModel().createRemoteObject(t.result),new a.RemoteObject.RemoteArrayBuffer(e)}(e),{internalProperties:r}=await o.object().getOwnProperties(!1),n=r?.find((({name:e})=>"[[ArrayBufferData]]"===e)),s=n?.value?.value;if(!s)throw new Error("Unable to find backing store id for array buffer");const d=r?.find((({name:e})=>"[[WebAssemblyMemory]]"===e)),l=d?.value;if(this.#O.has(s))return this.#N.reveal(s,t),void c.ViewManager.ViewManager.instance().showView("linear-memory-inspector");const h=String(l?l.description:o.object().description);this.#O.set(s,o.object());const p=new Ke(o);this.#N.create(s,h,p,t),c.ViewManager.ViewManager.instance().showView("linear-memory-inspector")}modelRemoved(e){for(const[t,o]of this.#O)e===o.runtimeModel()&&(this.#O.delete(t),this.#N.close(t))}onDebuggerPause(e){const t=e.data;for(const[e,o]of this.#O)t.runtimeModel()===o.runtimeModel()&&this.#N.refreshView(e)}onGlobalObjectClear(e){this.modelRemoved(e.data.runtimeModel())}viewClosed({data:e}){const t=this.#O.get(e);t&&t.release(),this.#O.delete(e)}}var Xe=Object.freeze({__proto__:null,ACCEPTED_MEMORY_TYPES:Ye,RemoteArrayBufferWrapper:Ke,LinearMemoryInspectorController:Je});export{Ve as LinearMemoryInspector,Xe as LinearMemoryInspectorController,We as LinearMemoryInspectorPane,we as LinearMemoryInspectorUtils,x as LinearMemoryNavigator,ge as LinearMemoryValueInterpreter,Ee as LinearMemoryViewer,Z as ValueInterpreterDisplay,z as ValueInterpreterDisplayUtils,se as ValueInterpreterSettings};
