import{tokTypes as t,SourceLocation as e,Node as s,lineBreak as i,isNewLine as r,Parser as n,Token as a,getLineInfo as o,lineBreakG as h,tokContexts as p,defaultOptions as c}from"../acorn/acorn.js";function u(t){return"✖"===t.name}function l(){}var d=function(s,i){if(void 0===i&&(i={}),this.toks=this.constructor.BaseParser.tokenizer(s,i),this.options=this.toks.options,this.input=this.toks.input,this.tok=this.last={type:t.eof,start:0,end:0},this.tok.validateRegExpFlags=l,this.tok.validateRegExpPattern=l,this.options.locations){var r=this.toks.curPosition();this.tok.loc=new e(this.toks,r,r)}this.ahead=[],this.context=[],this.curIndent=0,this.curLineStart=0,this.nextLineStart=this.lineEnd(this.curLineStart)+1,this.inAsync=!1,this.inGenerator=!1,this.inFunction=!1};d.prototype.startNode=function(){return new s(this.toks,this.tok.start,this.options.locations?this.tok.loc.start:null)},d.prototype.storeCurrentPos=function(){return this.options.locations?[this.tok.start,this.tok.loc.start]:this.tok.start},d.prototype.startNodeAt=function(t){return this.options.locations?new s(this.toks,t[0],t[1]):new s(this.toks,t)},d.prototype.finishNode=function(t,e){return t.type=e,t.end=this.last.end,this.options.locations&&(t.loc.end=this.last.loc.end),this.options.ranges&&(t.range[1]=this.last.end),t},d.prototype.dummyNode=function(e){var s=this.startNode();return s.type=e,s.end=s.start,this.options.locations&&(s.loc.end=s.loc.start),this.options.ranges&&(s.range[1]=s.start),this.last={type:t.name,start:s.start,end:s.start,loc:s.loc},s},d.prototype.dummyIdent=function(){var t=this.dummyNode("Identifier");return t.name="✖",t},d.prototype.dummyString=function(){var t=this.dummyNode("Literal");return t.value=t.raw="✖",t},d.prototype.eat=function(t){return this.tok.type===t&&(this.next(),!0)},d.prototype.isContextual=function(e){return this.tok.type===t.name&&this.tok.value===e},d.prototype.eatContextual=function(e){return this.tok.value===e&&this.eat(t.name)},d.prototype.canInsertSemicolon=function(){return this.tok.type===t.eof||this.tok.type===t.braceR||i.test(this.input.slice(this.last.end,this.tok.start))},d.prototype.semicolon=function(){return this.eat(t.semi)},d.prototype.expect=function(t){if(this.eat(t))return!0;for(var e=1;e<=2;e++)if(this.lookAhead(e).type===t){for(var s=0;s<e;s++)this.next();return!0}},d.prototype.pushCx=function(){this.context.push(this.curIndent)},d.prototype.popCx=function(){this.curIndent=this.context.pop()},d.prototype.lineEnd=function(t){for(;t<this.input.length&&!r(this.input.charCodeAt(t));)++t;return t},d.prototype.indentationAfter=function(t){for(var e=0;;++t){var s=this.input.charCodeAt(t);if(32===s)++e;else{if(9!==s)return e;e+=this.options.tabSize}}},d.prototype.closes=function(e,s,i,r){return this.tok.type===e||this.tok.type===t.eof||i!==this.curLineStart&&this.curIndent<s&&this.tokenStartsLine()&&(!r||this.nextLineStart>=this.input.length||this.indentationAfter(this.nextLineStart)<s)},d.prototype.tokenStartsLine=function(){for(var t=this.tok.start-1;t>=this.curLineStart;--t){var e=this.input.charCodeAt(t);if(9!==e&&32!==e)return!1}return!0},d.prototype.extend=function(t,e){this[t]=e(this[t])},d.prototype.parse=function(){return this.next(),this.parseTopLevel()},d.extend=function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];for(var s=this,i=0;i<t.length;i++)s=t[i](s);return s},d.parse=function(t,e){return new this(t,e).parse()},d.BaseParser=n;var f=d.prototype;function m(t){return t<14&&t>8||32===t||160===t||r(t)}f.next=function(){if(this.last=this.tok,this.ahead.length?this.tok=this.ahead.shift():this.tok=this.readToken(),this.tok.start>=this.nextLineStart){for(;this.tok.start>=this.nextLineStart;)this.curLineStart=this.nextLineStart,this.nextLineStart=this.lineEnd(this.curLineStart)+1;this.curIndent=this.indentationAfter(this.curLineStart)}},f.readToken=function(){for(;;)try{return this.toks.next(),this.toks.type===t.dot&&"."===this.input.substr(this.toks.end,1)&&this.options.ecmaVersion>=6&&(this.toks.end++,this.toks.type=t.ellipsis),new a(this.toks)}catch(a){if(!(a instanceof SyntaxError))throw a;var s=a.message,i=a.raisedAt,n=!0;if(/unterminated/i.test(s))if(i=this.lineEnd(a.pos+1),/string/.test(s))n={start:a.pos,end:i,type:t.string,value:this.input.slice(a.pos+1,i)};else if(/regular expr/i.test(s)){var h=this.input.slice(a.pos,i);try{h=new RegExp(h)}catch(t){}n={start:a.pos,end:i,type:t.regexp,value:h}}else n=!!/template/.test(s)&&{start:a.pos,end:i,type:t.template,value:this.input.slice(a.pos,i)};else if(/invalid (unicode|regexp|number)|expecting unicode|octal literal|is reserved|directly after number|expected number in radix/i.test(s))for(;i<this.input.length&&!m(this.input.charCodeAt(i));)++i;else if(/character escape|expected hexadecimal/i.test(s))for(;i<this.input.length;){var p=this.input.charCodeAt(i++);if(34===p||39===p||r(p))break}else if(/unexpected character/i.test(s))i++,n=!1;else{if(!/regular expression/i.test(s))throw a;n=!0}if(this.resetTo(i),!0===n&&(n={start:i,end:i,type:t.name,value:"✖"}),n)return this.options.locations&&(n.loc=new e(this.toks,o(this.input,n.start),o(this.input,n.end))),n}},f.resetTo=function(t){this.toks.pos=t;var e,s=this.input.charAt(t-1);if(this.toks.exprAllowed=!s||/[[{(,;:?/*=+\-~!|&%^<>]/.test(s)||/[enwfd]/.test(s)&&/\b(case|else|return|throw|new|in|(instance|type)?of|delete|void)$/.test(this.input.slice(t-10,t)),this.options.locations)for(this.toks.curLine=1,this.toks.lineStart=h.lastIndex=0;(e=h.exec(this.input))&&e.index<t;)++this.toks.curLine,this.toks.lineStart=e.index+e[0].length},f.lookAhead=function(t){for(;t>this.ahead.length;)this.ahead.push(this.readToken());return this.ahead[t-1]};var y=d.prototype;y.parseTopLevel=function(){var e=this.startNodeAt(this.options.locations?[0,o(this.input,0)]:0);for(e.body=[];this.tok.type!==t.eof;)e.body.push(this.parseStatement());return this.toks.adaptDirectivePrologue(e.body),this.last=this.tok,e.sourceType=this.options.sourceType,this.finishNode(e,"Program")},y.parseStatement=function(){var e,s=this.tok.type,i=this.startNode();switch(this.toks.isLet()&&(s=t._var,e="let"),s){case t._break:case t._continue:this.next();var r=s===t._break;return this.semicolon()||this.canInsertSemicolon()?i.label=null:(i.label=this.tok.type===t.name?this.parseIdent():null,this.semicolon()),this.finishNode(i,r?"BreakStatement":"ContinueStatement");case t._debugger:return this.next(),this.semicolon(),this.finishNode(i,"DebuggerStatement");case t._do:return this.next(),i.body=this.parseStatement(),i.test=this.eat(t._while)?this.parseParenExpression():this.dummyIdent(),this.semicolon(),this.finishNode(i,"DoWhileStatement");case t._for:this.next();var n=this.options.ecmaVersion>=9&&this.eatContextual("await");if(this.pushCx(),this.expect(t.parenL),this.tok.type===t.semi)return this.parseFor(i,null);var a=this.toks.isLet();if(a||this.tok.type===t._var||this.tok.type===t._const){var o=this.parseVar(this.startNode(),!0,a?"let":this.tok.value);return 1!==o.declarations.length||this.tok.type!==t._in&&!this.isContextual("of")?this.parseFor(i,o):(this.options.ecmaVersion>=9&&this.tok.type!==t._in&&(i.await=n),this.parseForIn(i,o))}var h=this.parseExpression(!0);return this.tok.type===t._in||this.isContextual("of")?(this.options.ecmaVersion>=9&&this.tok.type!==t._in&&(i.await=n),this.parseForIn(i,this.toAssignable(h))):this.parseFor(i,h);case t._function:return this.next(),this.parseFunction(i,!0);case t._if:return this.next(),i.test=this.parseParenExpression(),i.consequent=this.parseStatement(),i.alternate=this.eat(t._else)?this.parseStatement():null,this.finishNode(i,"IfStatement");case t._return:return this.next(),this.eat(t.semi)||this.canInsertSemicolon()?i.argument=null:(i.argument=this.parseExpression(),this.semicolon()),this.finishNode(i,"ReturnStatement");case t._switch:var p,c=this.curIndent,l=this.curLineStart;for(this.next(),i.discriminant=this.parseParenExpression(),i.cases=[],this.pushCx(),this.expect(t.braceL);!this.closes(t.braceR,c,l,!0);)if(this.tok.type===t._case||this.tok.type===t._default){var d=this.tok.type===t._case;p&&this.finishNode(p,"SwitchCase"),i.cases.push(p=this.startNode()),p.consequent=[],this.next(),p.test=d?this.parseExpression():null,this.expect(t.colon)}else p||(i.cases.push(p=this.startNode()),p.consequent=[],p.test=null),p.consequent.push(this.parseStatement());return p&&this.finishNode(p,"SwitchCase"),this.popCx(),this.eat(t.braceR),this.finishNode(i,"SwitchStatement");case t._throw:return this.next(),i.argument=this.parseExpression(),this.semicolon(),this.finishNode(i,"ThrowStatement");case t._try:if(this.next(),i.block=this.parseBlock(),i.handler=null,this.tok.type===t._catch){var f=this.startNode();this.next(),this.eat(t.parenL)?(f.param=this.toAssignable(this.parseExprAtom(),!0),this.expect(t.parenR)):f.param=null,f.body=this.parseBlock(),i.handler=this.finishNode(f,"CatchClause")}return i.finalizer=this.eat(t._finally)?this.parseBlock():null,i.handler||i.finalizer?this.finishNode(i,"TryStatement"):i.block;case t._var:case t._const:return this.parseVar(i,!1,e||this.tok.value);case t._while:return this.next(),i.test=this.parseParenExpression(),i.body=this.parseStatement(),this.finishNode(i,"WhileStatement");case t._with:return this.next(),i.object=this.parseParenExpression(),i.body=this.parseStatement(),this.finishNode(i,"WithStatement");case t.braceL:return this.parseBlock();case t.semi:return this.next(),this.finishNode(i,"EmptyStatement");case t._class:return this.parseClass(!0);case t._import:if(this.options.ecmaVersion>10){var m=this.lookAhead(1).type;if(m===t.parenL||m===t.dot)return i.expression=this.parseExpression(),this.semicolon(),this.finishNode(i,"ExpressionStatement")}return this.parseImport();case t._export:return this.parseExport();default:if(this.toks.isAsyncFunction())return this.next(),this.next(),this.parseFunction(i,!0,!0);var y=this.parseExpression();return u(y)?(this.next(),this.tok.type===t.eof?this.finishNode(i,"EmptyStatement"):this.parseStatement()):s===t.name&&"Identifier"===y.type&&this.eat(t.colon)?(i.body=this.parseStatement(),i.label=y,this.finishNode(i,"LabeledStatement")):(i.expression=y,this.semicolon(),this.finishNode(i,"ExpressionStatement"))}},y.parseBlock=function(){var e=this.startNode();this.pushCx(),this.expect(t.braceL);var s=this.curIndent,i=this.curLineStart;for(e.body=[];!this.closes(t.braceR,s,i,!0);)e.body.push(this.parseStatement());return this.popCx(),this.eat(t.braceR),this.finishNode(e,"BlockStatement")},y.parseFor=function(e,s){return e.init=s,e.test=e.update=null,this.eat(t.semi)&&this.tok.type!==t.semi&&(e.test=this.parseExpression()),this.eat(t.semi)&&this.tok.type!==t.parenR&&(e.update=this.parseExpression()),this.popCx(),this.expect(t.parenR),e.body=this.parseStatement(),this.finishNode(e,"ForStatement")},y.parseForIn=function(e,s){var i=this.tok.type===t._in?"ForInStatement":"ForOfStatement";return this.next(),e.left=s,e.right=this.parseExpression(),this.popCx(),this.expect(t.parenR),e.body=this.parseStatement(),this.finishNode(e,i)},y.parseVar=function(e,s,i){e.kind=i,this.next(),e.declarations=[];do{var r=this.startNode();r.id=this.options.ecmaVersion>=6?this.toAssignable(this.parseExprAtom(),!0):this.parseIdent(),r.init=this.eat(t.eq)?this.parseMaybeAssign(s):null,e.declarations.push(this.finishNode(r,"VariableDeclarator"))}while(this.eat(t.comma));if(!e.declarations.length){var n=this.startNode();n.id=this.dummyIdent(),e.declarations.push(this.finishNode(n,"VariableDeclarator"))}return s||this.semicolon(),this.finishNode(e,"VariableDeclaration")},y.parseClass=function(e){var s=this.startNode();this.next(),this.tok.type===t.name?s.id=this.parseIdent():s.id=!0===e?this.dummyIdent():null,s.superClass=this.eat(t._extends)?this.parseExpression():null,s.body=this.startNode(),s.body.body=[],this.pushCx();var i=this.curIndent+1,r=this.curLineStart;for(this.eat(t.braceL),this.curIndent+1<i&&(i=this.curIndent,r=this.curLineStart);!this.closes(t.braceR,i,r);){var n=this.parseClassElement();n&&s.body.body.push(n)}return this.popCx(),this.eat(t.braceR)||(this.last.end=this.tok.start,this.options.locations&&(this.last.loc.end=this.tok.loc.start)),this.semicolon(),this.finishNode(s.body,"ClassBody"),this.finishNode(s,e?"ClassDeclaration":"ClassExpression")},y.parseClassElement=function(){if(this.eat(t.semi))return null;var e=this.options,s=e.ecmaVersion,i=e.locations,r=this.curIndent,n=this.curLineStart,a=this.startNode(),o="",h=!1,p=!1,c="method",l=!1;if(this.eatContextual("static")){if(s>=13&&this.eat(t.braceL))return this.parseClassStaticBlock(a),a;this.isClassElementNameStart()||this.toks.type===t.star?l=!0:o="static"}if(a.static=l,!o&&s>=8&&this.eatContextual("async")&&(!this.isClassElementNameStart()&&this.toks.type!==t.star||this.canInsertSemicolon()?o="async":p=!0),!o){h=this.eat(t.star);var d=this.toks.value;(this.eatContextual("get")||this.eatContextual("set"))&&(this.isClassElementNameStart()?c=d:o=d)}if(o)a.computed=!1,a.key=this.startNodeAt(i?[this.toks.lastTokStart,this.toks.lastTokStartLoc]:this.toks.lastTokStart),a.key.name=o,this.finishNode(a.key,"Identifier");else if(this.parseClassElementName(a),u(a.key))return u(this.parseMaybeAssign())&&this.next(),this.eat(t.comma),null;if(s<13||this.toks.type===t.parenL||"method"!==c||h||p){var f=!a.computed&&!a.static&&!h&&!p&&"method"===c&&("Identifier"===a.key.type&&"constructor"===a.key.name||"Literal"===a.key.type&&"constructor"===a.key.value);a.kind=f?"constructor":c,a.value=this.parseMethod(h,p),this.finishNode(a,"MethodDefinition")}else{if(this.eat(t.eq))if(this.curLineStart!==n&&this.curIndent<=r&&this.tokenStartsLine())a.value=null;else{var m=this.inAsync,y=this.inGenerator;this.inAsync=!1,this.inGenerator=!1,a.value=this.parseMaybeAssign(),this.inAsync=m,this.inGenerator=y}else a.value=null;this.semicolon(),this.finishNode(a,"PropertyDefinition")}return a},y.parseClassStaticBlock=function(e){var s=this.curIndent,i=this.curLineStart;for(e.body=[],this.pushCx();!this.closes(t.braceR,s,i,!0);)e.body.push(this.parseStatement());return this.popCx(),this.eat(t.braceR),this.finishNode(e,"StaticBlock")},y.isClassElementNameStart=function(){return this.toks.isClassElementNameStart()},y.parseClassElementName=function(e){this.toks.type===t.privateId?(e.computed=!1,e.key=this.parsePrivateIdent()):this.parsePropertyName(e)},y.parseFunction=function(e,s,i){var r=this.inAsync,n=this.inGenerator,a=this.inFunction;return this.initFunction(e),this.options.ecmaVersion>=6&&(e.generator=this.eat(t.star)),this.options.ecmaVersion>=8&&(e.async=!!i),this.tok.type===t.name?e.id=this.parseIdent():!0===s&&(e.id=this.dummyIdent()),this.inAsync=e.async,this.inGenerator=e.generator,this.inFunction=!0,e.params=this.parseFunctionParams(),e.body=this.parseBlock(),this.toks.adaptDirectivePrologue(e.body.body),this.inAsync=r,this.inGenerator=n,this.inFunction=a,this.finishNode(e,s?"FunctionDeclaration":"FunctionExpression")},y.parseExport=function(){var e=this.startNode();if(this.next(),this.eat(t.star))return this.options.ecmaVersion>=11&&(this.eatContextual("as")?e.exported=this.parseExprAtom():e.exported=null),e.source=this.eatContextual("from")?this.parseExprAtom():this.dummyString(),this.finishNode(e,"ExportAllDeclaration");if(this.eat(t._default)){var s;if(this.tok.type===t._function||(s=this.toks.isAsyncFunction())){var i=this.startNode();this.next(),s&&this.next(),e.declaration=this.parseFunction(i,"nullableID",s)}else this.tok.type===t._class?e.declaration=this.parseClass("nullableID"):(e.declaration=this.parseMaybeAssign(),this.semicolon());return this.finishNode(e,"ExportDefaultDeclaration")}return this.tok.type.keyword||this.toks.isLet()||this.toks.isAsyncFunction()?(e.declaration=this.parseStatement(),e.specifiers=[],e.source=null):(e.declaration=null,e.specifiers=this.parseExportSpecifierList(),e.source=this.eatContextual("from")?this.parseExprAtom():null,this.semicolon()),this.finishNode(e,"ExportNamedDeclaration")},y.parseImport=function(){var e,s=this.startNode();(this.next(),this.tok.type===t.string)?(s.specifiers=[],s.source=this.parseExprAtom()):(this.tok.type===t.name&&"from"!==this.tok.value&&((e=this.startNode()).local=this.parseIdent(),this.finishNode(e,"ImportDefaultSpecifier"),this.eat(t.comma)),s.specifiers=this.parseImportSpecifiers(),s.source=this.eatContextual("from")&&this.tok.type===t.string?this.parseExprAtom():this.dummyString(),e&&s.specifiers.unshift(e));return this.semicolon(),this.finishNode(s,"ImportDeclaration")},y.parseImportSpecifiers=function(){var e=[];if(this.tok.type===t.star){var s=this.startNode();this.next(),s.local=this.eatContextual("as")?this.parseIdent():this.dummyIdent(),e.push(this.finishNode(s,"ImportNamespaceSpecifier"))}else{var i=this.curIndent,r=this.curLineStart,n=this.nextLineStart;for(this.pushCx(),this.eat(t.braceL),this.curLineStart>n&&(n=this.curLineStart);!this.closes(t.braceR,i+(this.curLineStart<=n?1:0),r);){var a=this.startNode();if(this.eat(t.star))a.local=this.eatContextual("as")?this.parseIdent():this.dummyIdent(),this.finishNode(a,"ImportNamespaceSpecifier");else{if(this.isContextual("from"))break;if(a.imported=this.parseIdent(),u(a.imported))break;a.local=this.eatContextual("as")?this.parseIdent():a.imported,this.finishNode(a,"ImportSpecifier")}e.push(a),this.eat(t.comma)}this.eat(t.braceR),this.popCx()}return e},y.parseExportSpecifierList=function(){var e=[],s=this.curIndent,i=this.curLineStart,r=this.nextLineStart;for(this.pushCx(),this.eat(t.braceL),this.curLineStart>r&&(r=this.curLineStart);!this.closes(t.braceR,s+(this.curLineStart<=r?1:0),i)&&!this.isContextual("from");){var n=this.startNode();if(n.local=this.parseIdent(),u(n.local))break;n.exported=this.eatContextual("as")?this.parseIdent():n.local,this.finishNode(n,"ExportSpecifier"),e.push(n),this.eat(t.comma)}return this.eat(t.braceR),this.popCx(),e};var x=d.prototype;x.checkLVal=function(t){if(!t)return t;switch(t.type){case"Identifier":case"MemberExpression":return t;case"ParenthesizedExpression":return t.expression=this.checkLVal(t.expression),t;default:return this.dummyIdent()}},x.parseExpression=function(e){var s=this.storeCurrentPos(),i=this.parseMaybeAssign(e);if(this.tok.type===t.comma){var r=this.startNodeAt(s);for(r.expressions=[i];this.eat(t.comma);)r.expressions.push(this.parseMaybeAssign(e));return this.finishNode(r,"SequenceExpression")}return i},x.parseParenExpression=function(){this.pushCx(),this.expect(t.parenL);var e=this.parseExpression();return this.popCx(),this.expect(t.parenR),e},x.parseMaybeAssign=function(e){if(this.inGenerator&&this.toks.isContextual("yield")){var s=this.startNode();return this.next(),this.semicolon()||this.canInsertSemicolon()||this.tok.type!==t.star&&!this.tok.type.startsExpr?(s.delegate=!1,s.argument=null):(s.delegate=this.eat(t.star),s.argument=this.parseMaybeAssign()),this.finishNode(s,"YieldExpression")}var i=this.storeCurrentPos(),r=this.parseMaybeConditional(e);if(this.tok.type.isAssign){var n=this.startNodeAt(i);return n.operator=this.tok.value,n.left=this.tok.type===t.eq?this.toAssignable(r):this.checkLVal(r),this.next(),n.right=this.parseMaybeAssign(e),this.finishNode(n,"AssignmentExpression")}return r},x.parseMaybeConditional=function(e){var s=this.storeCurrentPos(),i=this.parseExprOps(e);if(this.eat(t.question)){var r=this.startNodeAt(s);return r.test=i,r.consequent=this.parseMaybeAssign(),r.alternate=this.expect(t.colon)?this.parseMaybeAssign(e):this.dummyIdent(),this.finishNode(r,"ConditionalExpression")}return i},x.parseExprOps=function(t){var e=this.storeCurrentPos(),s=this.curIndent,i=this.curLineStart;return this.parseExprOp(this.parseMaybeUnary(!1),e,-1,t,s,i)},x.parseExprOp=function(e,s,i,r,n,a){if(this.curLineStart!==a&&this.curIndent<n&&this.tokenStartsLine())return e;var o=this.tok.type.binop;if(null!=o&&(!r||this.tok.type!==t._in)&&o>i){var h=this.startNodeAt(s);if(h.left=e,h.operator=this.tok.value,this.next(),this.curLineStart!==a&&this.curIndent<n&&this.tokenStartsLine())h.right=this.dummyIdent();else{var p=this.storeCurrentPos();h.right=this.parseExprOp(this.parseMaybeUnary(!1),p,o,r,n,a)}return this.finishNode(h,/&&|\|\||\?\?/.test(h.operator)?"LogicalExpression":"BinaryExpression"),this.parseExprOp(h,s,i,r,n,a)}return e},x.parseMaybeUnary=function(e){var s,i=this.storeCurrentPos();if(this.options.ecmaVersion>=8&&this.toks.isContextual("await")&&(this.inAsync||this.toks.inModule&&this.options.ecmaVersion>=13||!this.inFunction&&this.options.allowAwaitOutsideFunction))s=this.parseAwait(),e=!0;else if(this.tok.type.prefix){var r=this.startNode(),n=this.tok.type===t.incDec;n||(e=!0),r.operator=this.tok.value,r.prefix=!0,this.next(),r.argument=this.parseMaybeUnary(!0),n&&(r.argument=this.checkLVal(r.argument)),s=this.finishNode(r,n?"UpdateExpression":"UnaryExpression")}else if(this.tok.type===t.ellipsis){var a=this.startNode();this.next(),a.argument=this.parseMaybeUnary(e),s=this.finishNode(a,"SpreadElement")}else for(s=this.parseExprSubscripts();this.tok.type.postfix&&!this.canInsertSemicolon();){var o=this.startNodeAt(i);o.operator=this.tok.value,o.prefix=!1,o.argument=this.checkLVal(s),this.next(),s=this.finishNode(o,"UpdateExpression")}if(!e&&this.eat(t.starstar)){var h=this.startNodeAt(i);return h.operator="**",h.left=s,h.right=this.parseMaybeUnary(!1),this.finishNode(h,"BinaryExpression")}return s},x.parseExprSubscripts=function(){var t=this.storeCurrentPos();return this.parseSubscripts(this.parseExprAtom(),t,!1,this.curIndent,this.curLineStart)},x.parseSubscripts=function(e,s,i,r,n){for(var a=this.options.ecmaVersion>=11,o=!1;;){if(this.curLineStart!==n&&this.curIndent<=r&&this.tokenStartsLine()){if(this.tok.type!==t.dot||this.curIndent!==r)break;--r}var h="Identifier"===e.type&&"async"===e.name&&!this.canInsertSemicolon(),p=a&&this.eat(t.questionDot);if(p&&(o=!0),p&&this.tok.type!==t.parenL&&this.tok.type!==t.bracketL&&this.tok.type!==t.backQuote||this.eat(t.dot)){var c=this.startNodeAt(s);c.object=e,this.curLineStart!==n&&this.curIndent<=r&&this.tokenStartsLine()?c.property=this.dummyIdent():c.property=this.parsePropertyAccessor()||this.dummyIdent(),c.computed=!1,a&&(c.optional=p),e=this.finishNode(c,"MemberExpression")}else if(this.tok.type===t.bracketL){this.pushCx(),this.next();var u=this.startNodeAt(s);u.object=e,u.property=this.parseExpression(),u.computed=!0,a&&(u.optional=p),this.popCx(),this.expect(t.bracketR),e=this.finishNode(u,"MemberExpression")}else if(i||this.tok.type!==t.parenL){if(this.tok.type!==t.backQuote)break;var l=this.startNodeAt(s);l.tag=e,l.quasi=this.parseTemplate(),e=this.finishNode(l,"TaggedTemplateExpression")}else{var d=this.parseExprList(t.parenR);if(h&&this.eat(t.arrow))return this.parseArrowExpression(this.startNodeAt(s),d,!0);var f=this.startNodeAt(s);f.callee=e,f.arguments=d,a&&(f.optional=p),e=this.finishNode(f,"CallExpression")}}if(o){var m=this.startNodeAt(s);m.expression=e,e=this.finishNode(m,"ChainExpression")}return e},x.parseExprAtom=function(){var e;switch(this.tok.type){case t._this:case t._super:var s=this.tok.type===t._this?"ThisExpression":"Super";return e=this.startNode(),this.next(),this.finishNode(e,s);case t.name:var i=this.storeCurrentPos(),r=this.parseIdent(),n=!1;if("async"===r.name&&!this.canInsertSemicolon()){if(this.eat(t._function))return this.toks.overrideContext(p.f_expr),this.parseFunction(this.startNodeAt(i),!1,!0);this.tok.type===t.name&&(r=this.parseIdent(),n=!0)}return this.eat(t.arrow)?this.parseArrowExpression(this.startNodeAt(i),[r],n):r;case t.regexp:e=this.startNode();var a=this.tok.value;return e.regex={pattern:a.pattern,flags:a.flags},e.value=a.value,e.raw=this.input.slice(this.tok.start,this.tok.end),this.next(),this.finishNode(e,"Literal");case t.num:case t.string:return(e=this.startNode()).value=this.tok.value,e.raw=this.input.slice(this.tok.start,this.tok.end),this.tok.type===t.num&&110===e.raw.charCodeAt(e.raw.length-1)&&(e.bigint=e.raw.slice(0,-1).replace(/_/g,"")),this.next(),this.finishNode(e,"Literal");case t._null:case t._true:case t._false:return(e=this.startNode()).value=this.tok.type===t._null?null:this.tok.type===t._true,e.raw=this.tok.type.keyword,this.next(),this.finishNode(e,"Literal");case t.parenL:var o=this.storeCurrentPos();this.next();var h=this.parseExpression();if(this.expect(t.parenR),this.eat(t.arrow)){var c=h.expressions||[h];return c.length&&u(c[c.length-1])&&c.pop(),this.parseArrowExpression(this.startNodeAt(o),c)}if(this.options.preserveParens){var l=this.startNodeAt(o);l.expression=h,h=this.finishNode(l,"ParenthesizedExpression")}return h;case t.bracketL:return(e=this.startNode()).elements=this.parseExprList(t.bracketR,!0),this.finishNode(e,"ArrayExpression");case t.braceL:return this.toks.overrideContext(p.b_expr),this.parseObj();case t._class:return this.parseClass(!1);case t._function:return e=this.startNode(),this.next(),this.parseFunction(e,!1);case t._new:return this.parseNew();case t.backQuote:return this.parseTemplate();case t._import:return this.options.ecmaVersion>=11?this.parseExprImport():this.dummyIdent();default:return this.dummyIdent()}},x.parseExprImport=function(){var e=this.startNode(),s=this.parseIdent(!0);switch(this.tok.type){case t.parenL:return this.parseDynamicImport(e);case t.dot:return e.meta=s,this.parseImportMeta(e);default:return e.name="import",this.finishNode(e,"Identifier")}},x.parseDynamicImport=function(e){return e.source=this.parseExprList(t.parenR)[0]||this.dummyString(),this.finishNode(e,"ImportExpression")},x.parseImportMeta=function(t){return this.next(),t.property=this.parseIdent(!0),this.finishNode(t,"MetaProperty")},x.parseNew=function(){var e=this.startNode(),s=this.curIndent,i=this.curLineStart,r=this.parseIdent(!0);if(this.options.ecmaVersion>=6&&this.eat(t.dot))return e.meta=r,e.property=this.parseIdent(!0),this.finishNode(e,"MetaProperty");var n=this.storeCurrentPos();return e.callee=this.parseSubscripts(this.parseExprAtom(),n,!0,s,i),this.tok.type===t.parenL?e.arguments=this.parseExprList(t.parenR):e.arguments=[],this.finishNode(e,"NewExpression")},x.parseTemplateElement=function(){var e=this.startNode();return this.tok.type===t.invalidTemplate?e.value={raw:this.tok.value,cooked:null}:e.value={raw:this.input.slice(this.tok.start,this.tok.end).replace(/\r\n?/g,"\n"),cooked:this.tok.value},this.next(),e.tail=this.tok.type===t.backQuote,this.finishNode(e,"TemplateElement")},x.parseTemplate=function(){var e=this.startNode();this.next(),e.expressions=[];var s=this.parseTemplateElement();for(e.quasis=[s];!s.tail;)this.next(),e.expressions.push(this.parseExpression()),this.expect(t.braceR)?s=this.parseTemplateElement():((s=this.startNode()).value={cooked:"",raw:""},s.tail=!0,this.finishNode(s,"TemplateElement")),e.quasis.push(s);return this.expect(t.backQuote),this.finishNode(e,"TemplateLiteral")},x.parseObj=function(){var e=this.startNode();e.properties=[],this.pushCx();var s=this.curIndent+1,i=this.curLineStart;for(this.eat(t.braceL),this.curIndent+1<s&&(s=this.curIndent,i=this.curLineStart);!this.closes(t.braceR,s,i);){var r=this.startNode(),n=void 0,a=void 0,o=void 0;if(this.options.ecmaVersion>=9&&this.eat(t.ellipsis))r.argument=this.parseMaybeAssign(),e.properties.push(this.finishNode(r,"SpreadElement")),this.eat(t.comma);else if(this.options.ecmaVersion>=6&&(o=this.storeCurrentPos(),r.method=!1,r.shorthand=!1,n=this.eat(t.star)),this.parsePropertyName(r),this.toks.isAsyncProp(r)?(a=!0,n=this.options.ecmaVersion>=9&&this.eat(t.star),this.parsePropertyName(r)):a=!1,u(r.key))u(this.parseMaybeAssign())&&this.next(),this.eat(t.comma);else{if(this.eat(t.colon))r.kind="init",r.value=this.parseMaybeAssign();else if(this.options.ecmaVersion>=6&&(this.tok.type===t.parenL||this.tok.type===t.braceL))r.kind="init",r.method=!0,r.value=this.parseMethod(n,a);else if(this.options.ecmaVersion>=5&&"Identifier"===r.key.type&&!r.computed&&("get"===r.key.name||"set"===r.key.name)&&this.tok.type!==t.comma&&this.tok.type!==t.braceR&&this.tok.type!==t.eq)r.kind=r.key.name,this.parsePropertyName(r),r.value=this.parseMethod(!1);else{if(r.kind="init",this.options.ecmaVersion>=6)if(this.eat(t.eq)){var h=this.startNodeAt(o);h.operator="=",h.left=r.key,h.right=this.parseMaybeAssign(),r.value=this.finishNode(h,"AssignmentExpression")}else r.value=r.key;else r.value=this.dummyIdent();r.shorthand=!0}e.properties.push(this.finishNode(r,"Property")),this.eat(t.comma)}}return this.popCx(),this.eat(t.braceR)||(this.last.end=this.tok.start,this.options.locations&&(this.last.loc.end=this.tok.loc.start)),this.finishNode(e,"ObjectExpression")},x.parsePropertyName=function(e){if(this.options.ecmaVersion>=6){if(this.eat(t.bracketL))return e.computed=!0,e.key=this.parseExpression(),void this.expect(t.bracketR);e.computed=!1}var s=this.tok.type===t.num||this.tok.type===t.string?this.parseExprAtom():this.parseIdent();e.key=s||this.dummyIdent()},x.parsePropertyAccessor=function(){return this.tok.type===t.name||this.tok.type.keyword?this.parseIdent():this.tok.type===t.privateId?this.parsePrivateIdent():void 0},x.parseIdent=function(){var e=this.tok.type===t.name?this.tok.value:this.tok.type.keyword;if(!e)return this.dummyIdent();var s=this.startNode();return this.next(),s.name=e,this.finishNode(s,"Identifier")},x.parsePrivateIdent=function(){var t=this.startNode();return t.name=this.tok.value,this.next(),this.finishNode(t,"PrivateIdentifier")},x.initFunction=function(t){t.id=null,t.params=[],this.options.ecmaVersion>=6&&(t.generator=!1,t.expression=!1),this.options.ecmaVersion>=8&&(t.async=!1)},x.toAssignable=function(t,e){if(!t||"Identifier"===t.type||"MemberExpression"===t.type&&!e);else if("ParenthesizedExpression"===t.type)this.toAssignable(t.expression,e);else{if(this.options.ecmaVersion<6)return this.dummyIdent();if("ObjectExpression"===t.type){t.type="ObjectPattern";for(var s=0,i=t.properties;s<i.length;s+=1){var r=i[s];this.toAssignable(r,e)}}else if("ArrayExpression"===t.type)t.type="ArrayPattern",this.toAssignableList(t.elements,e);else if("Property"===t.type)this.toAssignable(t.value,e);else if("SpreadElement"===t.type)t.type="RestElement",this.toAssignable(t.argument,e);else{if("AssignmentExpression"!==t.type)return this.dummyIdent();t.type="AssignmentPattern",delete t.operator}}return t},x.toAssignableList=function(t,e){for(var s=0,i=t;s<i.length;s+=1){var r=i[s];this.toAssignable(r,e)}return t},x.parseFunctionParams=function(e){return e=this.parseExprList(t.parenR),this.toAssignableList(e,!0)},x.parseMethod=function(t,e){var s=this.startNode(),i=this.inAsync,r=this.inGenerator,n=this.inFunction;return this.initFunction(s),this.options.ecmaVersion>=6&&(s.generator=!!t),this.options.ecmaVersion>=8&&(s.async=!!e),this.inAsync=s.async,this.inGenerator=s.generator,this.inFunction=!0,s.params=this.parseFunctionParams(),s.body=this.parseBlock(),this.toks.adaptDirectivePrologue(s.body.body),this.inAsync=i,this.inGenerator=r,this.inFunction=n,this.finishNode(s,"FunctionExpression")},x.parseArrowExpression=function(e,s,i){var r=this.inAsync,n=this.inGenerator,a=this.inFunction;return this.initFunction(e),this.options.ecmaVersion>=8&&(e.async=!!i),this.inAsync=e.async,this.inGenerator=!1,this.inFunction=!0,e.params=this.toAssignableList(s,!0),e.expression=this.tok.type!==t.braceL,e.expression?e.body=this.parseMaybeAssign():(e.body=this.parseBlock(),this.toks.adaptDirectivePrologue(e.body.body)),this.inAsync=r,this.inGenerator=n,this.inFunction=a,this.finishNode(e,"ArrowFunctionExpression")},x.parseExprList=function(e,s){this.pushCx();var i=this.curIndent,r=this.curLineStart,n=[];for(this.next();!this.closes(e,i+1,r);)if(this.eat(t.comma))n.push(s?null:this.dummyIdent());else{var a=this.parseMaybeAssign();if(u(a)){if(this.closes(e,i,r))break;this.next()}else n.push(a);this.eat(t.comma)}return this.popCx(),this.eat(e)||(this.last.end=this.tok.start,this.options.locations&&(this.last.loc.end=this.tok.loc.start)),n},x.parseAwait=function(){var t=this.startNode();return this.next(),t.argument=this.parseMaybeUnary(),this.finishNode(t,"AwaitExpression")},c.tabSize=4;var k=Object.freeze({__proto__:null,LooseParser:d,isDummy:u,parse:function(t,e){return d.parse(t,e)}});export{k as AcornLoose};
